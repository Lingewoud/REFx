/***************************************************** * Based on GetProfile.jsfl by C.Wilson - abitofcode * ****************************************************/ var ExportProfile ={	config 				: '',	exportPath			: '',		init : function(config) {		this.config 			= config;		this.exportPath			= config.outputFilePath.substring(7);	},		createProfile : function (name, w, h, fileType) {		var png 	= (fileType == undefined) ? 1 : 0;		var gif		= (fileType == 'GIF') ? 1 : 0;		var jpg		= (fileType == 'JPG') ? 1 : 0;		var profile = 	'<?xml version="1.0"?>\n' + 		'<flash_profile version="1.0" name="Default">\n' + 		'  <PublishFormatProperties enabled="true">\n' + 		'    <defaultNames>0</defaultNames>\n' + 		'    <flash>0</flash>\n' + 		'    <generator>0</generator>\n' + 		'    <projectorWin>0</projectorWin>\n' + 		'    <projectorMac>0</projectorMac>\n' + 		'    <html>0</html>\n' + 		'    <gif>'+ gif +'</gif>\n' + 		'    <jpeg>'+ jpg +'</jpeg>\n' + 		'    <png>'+ png +'</png>\n' + 		'    <qt>0</qt>\n' + 		'    <rnwk>0</rnwk>\n' + 		'    <flashDefaultName>0</flashDefaultName>\n' + 		'    <generatorDefaultName>1</generatorDefaultName>\n' + 		'    <projectorWinDefaultName>1</projectorWinDefaultName>\n' + 		'    <projectorMacDefaultName>1</projectorMacDefaultName>\n' + 		'    <htmlDefaultName>1</htmlDefaultName>\n' + 		'    <gifDefaultName>0</gifDefaultName>\n' + 		'    <jpegDefaultName>0</jpegDefaultName>\n' + 		'    <pngDefaultName>0</pngDefaultName>\n' + 		'    <qtDefaultName>1</qtDefaultName>\n' + 		'    <rnwkDefaultName>1</rnwkDefaultName>\n' + 		'    <flashFileName>' + this.exportPath + name + '.swf</flashFileName>\n' + 		'    <generatorFileName>' + this.exportPath + name + '.swt</generatorFileName>\n' + 		'    <projectorWinFileName>' + this.exportPath + name + '.exe</projectorWinFileName>\n' + 		'    <projectorMacFileName>' + this.exportPath + name + '.app</projectorMacFileName>\n' + 		'    <htmlFileName>' + this.exportPath + name + '.html</htmlFileName>\n' + 		'    <gifFileName>' + this.exportPath + name + '.gif</gifFileName>\n' + 		'    <jpegFileName>' + this.exportPath + name + '.jpg</jpegFileName>\n' + 		'    <pngFileName>' + this.exportPath + name + '.png</pngFileName>\n' + 		'    <qtFileName>' + this.exportPath + name + '.mov</qtFileName>\n' + 		'    <rnwkFileName>' + this.exportPath + name + '.smil</rnwkFileName>\n' + 		'  </PublishFormatProperties>\n' + 		'  <PublishHtmlProperties enabled="true">\n' + 		'    <VersionDetectionIfAvailable>0</VersionDetectionIfAvailable>\n' + 		'    <VersionInfo>9,0,115,0;8,0,24,0;7,0,14,0;6,0,79,0;5,0,58,0;4,0,32,0;3,0,8,0;2,0,1,12;1,0,0,1;</VersionInfo>\n' + 		'    <UsingDefaultContentFilename>1</UsingDefaultContentFilename>\n' + 		'    <UsingDefaultAlternateFilename>1</UsingDefaultAlternateFilename>\n' + 		'    <ContentFilename>'+ name + '.html</ContentFilename>\n' + 		'    <AlternateFilename>'+ name + 'html</AlternateFilename>\n' + 		'    <UsingOwnAlternateFile>0</UsingOwnAlternateFile>\n' + 		'    <OwnAlternateFilename></OwnAlternateFilename>\n' +    	 	'    <Width>' + w + '</Width>\n'+   	 	'    <Height>' + h + '</Height>\n'+		'    <Align>0</Align>\n' + 		'    <Units>0</Units>\n' + 		'    <Loop>1</Loop>\n' + 		'    <StartPaused>0</StartPaused>\n' + 		'    <Scale>0</Scale>\n' + 		'    <HorizontalAlignment>1</HorizontalAlignment>\n' + 		'    <VerticalAlignment>1</VerticalAlignment>\n' + 		'    <Quality>4</Quality>\n' + 		'    <WindowMode>0</WindowMode>\n' + 		'    <DisplayMenu>1</DisplayMenu>\n' + 		'    <DeviceFont>0</DeviceFont>\n' + 		'    <TemplateFileName>/Users/abitofcode/Library/Application Support/Adobe/Flash CS3/en/Configuration/HTML/Default.html</TemplateFileName>\n' + 		'    <showTagWarnMsg>1</showTagWarnMsg>\n' + 		'  </PublishHtmlProperties>\n' + 		'  <PublishFlashProperties enabled="true">\n' + 		'    <TopDown>0</TopDown>\n' + 		'    <Report>0</Report>\n' + 		'    <Protect>0</Protect>\n' + 		'    <OmitTraceActions>0</OmitTraceActions>\n' + 		'    <Quality>100</Quality>\n' + 		'    <StreamFormat>0</StreamFormat>\n' + 		'    <StreamCompress>7</StreamCompress>\n' + 		'    <EventFormat>0</EventFormat>\n' + 		'    <EventCompress>7</EventCompress>\n' + 		'    <OverrideSounds>0</OverrideSounds>\n' + 		'    <Version>8</Version>\n' + 		'    <ExternalPlayer></ExternalPlayer>\n' + 		'    <ActionScriptVersion>1</ActionScriptVersion>\n' + 		'    <PackageExportFrame>1</PackageExportFrame>\n' + 		'    <PackagePaths></PackagePaths>\n' + 		'    <AS3PackagePaths></AS3PackagePaths>\n' + 		'    <DebuggingPermitted>0</DebuggingPermitted>\n' + 		'    <DebuggingPassword></DebuggingPassword>\n' + 		'    <CompressMovie>1</CompressMovie>\n' + 		'    <FireFox>0</FireFox>\n' + 		'    <InvisibleLayer>1</InvisibleLayer>\n' + 		'    <DeviceSound>0</DeviceSound>\n' + 		'    <StreamUse8kSampleRate>0</StreamUse8kSampleRate>\n' + 		'    <EventUse8kSampleRate>0</EventUse8kSampleRate>\n' + 		'    <UseNetwork>0</UseNetwork>\n' + 		'    <DocumentClass></DocumentClass>\n' + 		'    <AS3Strict>1</AS3Strict>\n' + 		'    <AS3Coach>1</AS3Coach>\n' + 		'    <AS3AutoDeclare>1</AS3AutoDeclare>\n' + 		'    <AS3Dialect>AS3</AS3Dialect>\n' + 		'    <AS3ExportFrame>1</AS3ExportFrame>\n' + 		'    <AS3Optimize>1</AS3Optimize>\n' + 		'    <ExportSwc>0</ExportSwc>\n' + 		'    <ScriptStuckDelay>15</ScriptStuckDelay>\n' + 		'  </PublishFlashProperties>\n' + 		'  <PublishJpegProperties enabled="true">\n' +    	 	'    <Width>' + w + '</Width>\n'+    	'    <Height>' + h + '</Height>\n'+		'    <Progressive>0</Progressive>\n' + 		'    <DPI>4718592</DPI>\n' + 		'    <Size>0</Size>\n' + 		'    <Quality>80</Quality>\n' + 		'    <MatchMovieDim>1</MatchMovieDim>\n' + 		'  </PublishJpegProperties>\n' + 		'  <PublishRNWKProperties enabled="true">\n' + 		'    <exportFlash>1</exportFlash>\n' + 		'    <flashBitRate>0</flashBitRate>\n' + 		'    <exportAudio>1</exportAudio>\n' + 		'    <audioFormat>0</audioFormat>\n' + 		'    <singleRateAudio>0</singleRateAudio>\n' + 		'    <realVideoRate>100000</realVideoRate>\n' + 		'    <speed28K>1</speed28K>\n' + 		'    <speed56K>1</speed56K>\n' + 		'    <speedSingleISDN>0</speedSingleISDN>\n' + 		'    <speedDualISDN>0</speedDualISDN>\n' + 		'    <speedCorporateLAN>0</speedCorporateLAN>\n' + 		'    <speed256K>0</speed256K>\n' + 		'    <speed384K>0</speed384K>\n' + 		'    <speed512K>0</speed512K>\n' + 		'    <exportSMIL>1</exportSMIL>\n' + 		'  </PublishRNWKProperties>\n' + 		'  <PublishGifProperties enabled="true">\n' +    	 	'    <Width>' + w + '</Width>\n'+    	'    <Height>' + h + '</Height>\n'+		'    <Animated>1</Animated>\n' + 		'    <MatchMovieDim>1</MatchMovieDim>\n' + 		'    <Loop>0</Loop>\n' + 		'    <LoopCount>1</LoopCount>\n' + 		'    <OptimizeColors>1</OptimizeColors>\n' + 		'    <Interlace>0</Interlace>\n' + 		'    <Smooth>1</Smooth>\n' + 		'    <DitherSolids>0</DitherSolids>\n' + 		'    <RemoveGradients>1</RemoveGradients>\n' + 		'    <TransparentOption></TransparentOption>\n' + 		'    <TransparentAlpha>128</TransparentAlpha>\n' + 		'    <DitherOption></DitherOption>\n' + 		'    <PaletteOption>Adaptive</PaletteOption>\n' + 		'    <MaxColors>255</MaxColors>\n' + 		'    <PaletteName>Adaptive</PaletteName>\n' + 		'  </PublishGifProperties>\n' + 		'  <PublishPNGProperties enabled="true">\n' + 	    '    <Width>' + w + '</Width>\n'+	    '    <Height>' + h + '</Height>\n'+		'    <OptimizeColors>1</OptimizeColors>\n' + 		'    <Interlace>0</Interlace>\n' + 		'    <Transparent>0</Transparent>\n' + 		'    <Smooth>1</Smooth>\n' + 		'    <DitherSolids>0</DitherSolids>\n' + 		'    <RemoveGradients>0</RemoveGradients>\n' + 		'    <MatchMovieDim>1</MatchMovieDim>\n' + 		'    <DitherOption>None</DitherOption>\n' + 		'    <FilterOption>None</FilterOption>\n' + 		'    <PaletteOption>Web 216</PaletteOption>\n' + 		'    <BitDepth>24-bit with Alpha</BitDepth>\n' + 		'    <MaxColors>255</MaxColors>\n' + 		'    <PaletteName></PaletteName>\n' + 		'  </PublishPNGProperties>\n' + 		'  <PublishQTProperties enabled="true">\n' +  	   	'    <Width>' + w + '</Width>\n'+ 	   	'    <Height>' + h + '</Height>\n'+		'    <MatchMovieDim>1</MatchMovieDim>\n' + 		'    <UseQTSoundCompression>0</UseQTSoundCompression>\n' + 		'    <AlphaOption></AlphaOption>\n' + 		'    <LayerOption></LayerOption>\n' + 		'    <QTSndSettings>00000000</QTSndSettings>\n' + 		'    <ControllerOption>0</ControllerOption>\n' + 		'    <Looping>0</Looping>\n' + 		'    <PausedAtStart>0</PausedAtStart>\n' + 		'    <PlayEveryFrame>0</PlayEveryFrame>\n' + 		'    <Flatten>1</Flatten>\n' + 		'  </PublishQTProperties>\n' + 		'</flash_profile>\n';				FLfile.write(config.profileFilePath, profile);	}}